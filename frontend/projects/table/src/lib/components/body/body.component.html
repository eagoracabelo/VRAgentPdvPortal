@if (loadingIndicator) {
  <table-progress> </table-progress>
}
<table-selection
  #selector
  [selected]="selected"
  [rows]="rows"
  [selectCheck]="selectCheck"
  [selectEnabled]="selectEnabled"
  [selectionType]="selectionType"
  [rowIdentity]="rowIdentity"
  (select)="select.emit($event)"
  (activate)="activate.emit($event)"
>
  @if (rows?.length) {
    <table-scroller
      [scrollbarV]="scrollbarV"
      [scrollbarH]="scrollbarH"
      [scrollHeight]="scrollHeight"
      [scrollWidth]="columnGroupWidths?.total"
      (scroll)="onBodyScroll($event)"
    >
      @if (summaryRow && summaryPosition === 'top') {
        <table-summary-row
          [rowHeight]="summaryHeight"
          [offsetX]="offsetX"
          [innerWidth]="innerWidth"
          [rows]="rows"
          [columns]="columns"
        >
        </table-summary-row>
      }
      @for (group of temp; track $index; let i = $index) {
        <table-row-wrapper
          [groupedRows]="groupedRows"
          [innerWidth]="innerWidth"
          [ngStyle]="getRowsStyles(group)"
          [rowDetail]="rowDetail"
          [groupHeader]="groupHeader"
          [offsetX]="offsetX"
          [detailRowHeight]="getDetailRowHeight(group && group[i], i)"
          [row]="group"
          [expanded]="getRowExpanded(group)"
          [rowIndex]="getRowIndex(group && group[i])"
          (rowContextmenu)="rowContextmenu.emit($event)"
        >
          @if (!groupedRows) {
            <table-body-row
              role="row"
              tabindex="-1"
              [isSelected]="selector.getRowSelected(group)"
              [innerWidth]="innerWidth"
              [offsetX]="offsetX"
              [columns]="columns"
              [rowHeight]="getRowHeight(group)"
              [row]="group"
              [rowIndex]="getRowIndex(group)"
              [expanded]="getRowExpanded(group)"
              [rowClass]="rowClass"
              [displayCheck]="displayCheck"
              [treeStatus]="group && group.treeStatus"
              (treeAction)="onTreeAction(group)"
              (activate)="selector.onActivate($event, indexes.first + i)"
              [clickableRows]="clickableRows"
            >
            </table-body-row>
          } @else {
            @for (row of group?.value; track $index; let i = $index) {
              <table-body-row
                role="row"
                tabindex="-1"
                [isSelected]="selector.getRowSelected(row)"
                [innerWidth]="innerWidth"
                [offsetX]="offsetX"
                [columns]="columns"
                [rowHeight]="getRowHeight(row)"
                [row]="row"
                [group]="group.value"
                [rowIndex]="getRowIndex(row)"
                [expanded]="getRowExpanded(row)"
                [rowClass]="rowClass"
                (activate)="selector.onActivate($event, i)"
              >
              </table-body-row>
            }
          }
        </table-row-wrapper>
      }

      @if (summaryRow && summaryPosition === 'bottom') {
        <table-summary-row
          role="row"
          [ngStyle]="getBottomSummaryRowStyles()"
          [rowHeight]="summaryHeight"
          [offsetX]="offsetX"
          [innerWidth]="innerWidth"
          [rows]="rows"
          [columns]="columns"
        >
        </table-summary-row>
      }
    </table-scroller>
  }

  @if (!rows?.length && !loadingIndicator) {
    <div class="empty-row" [innerHTML]="emptyMessage | translate"></div>
  }
</table-selection>
