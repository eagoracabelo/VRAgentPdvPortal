@if (loadingIndicator) {
  <datatable-progress> </datatable-progress>
}
<datatable-selection
  #selector
  [selected]="selected"
  [rows]="rows"
  [selectCheck]="selectCheck"
  [selectEnabled]="selectEnabled"
  [selectionType]="selectionType"
  [rowIdentity]="rowIdentity"
  (select)="select.emit($event)"
  (activate)="activate.emit($event)"
  [rowClickActiveSelected]="rowClickActiveSelected"
>
  <datatable-scroller
    [scrollbarV]="scrollbarV"
    [scrollbarH]="scrollbarH"
    [scrollHeight]="scrollHeight"
    [scrollWidth]="columnGroupWidths?.total"
    (scroll)="onBodyScroll($event)"
  >
    @if (rows?.length) {
      <div>
        @if (summaryRow && summaryPosition === 'top') {
          <datatable-summary-row
            [rowHeight]="summaryHeight"
            [offsetX]="offsetX"
            [innerWidth]="innerWidth"
            [rows]="rows"
            [columns]="columns"
          >
          </datatable-summary-row>
        }
        @for (group of temp; track $index; let i = $index; let l = $count) {
          <datatable-row-wrapper
            [groupedRows]="groupedRows"
            [innerWidth]="innerWidth"
            [ngStyle]="getRowsStyles(group)"
            [rowDetail]="rowDetail"
            [groupHeader]="groupHeader"
            [offsetX]="offsetX"
            [detailRowHeight]="getDetailRowHeight(group && group[i], i)"
            [row]="group"
            [expanded]="getRowExpanded(group)"
            [rowIndex]="getRowIndex(group && group[i])"
            (rowContextmenu)="rowContextmenu.emit($event)"
            [zindexRowOverNextRow]="zindexRowOverNextRow"
            [count]="l"
            [index]="i"
          >
            @if (!groupedRows) {
              <datatable-body-row
                role="row"
                [class]="{ 'error-row': hasError(group) }"
                tabindex="-1"
                [isSelected]="selector.getRowSelected(group)"
                [innerWidth]="innerWidth"
                [offsetX]="offsetX"
                [columns]="columns"
                [rowHeight]="getRowHeight(group)"
                [row]="group"
                [rowIndex]="getRowIndex(group)"
                [expanded]="getRowExpanded(group)"
                [rowClass]="rowClass"
                [displayCheck]="displayCheck"
                [treeStatus]="group && group.treeStatus"
                (treeAction)="onTreeAction(group)"
                (activate)="selector.onActivate($event, indexes.first + i)"
                [isEditColumn]="isEditColumn"
                [clickableRows]="clickableRows"
                [selectedRowClicked]="selector.selectedRowClicked"
                [preventDefaultClickEnable]="preventDefaultClickEnable"
                [rowAdd]="rowAdd"
              >
              </datatable-body-row>
            } @else {
              @for (row of group?.value; track $index; let i = $index) {
                <datatable-body-row
                  role="row"
                  tabindex="-1"
                  [isSelected]="selector.getRowSelected(row)"
                  [innerWidth]="innerWidth"
                  [offsetX]="offsetX"
                  [columns]="columns"
                  [rowHeight]="getRowHeight(row)"
                  [row]="row"
                  [group]="group.value"
                  [rowIndex]="getRowIndex(row)"
                  [expanded]="getRowExpanded(row)"
                  [rowClass]="rowClass"
                  (activate)="selector.onActivate($event, i)"
                  [isEditColumn]="isEditColumn"
                  [rowAdd]="rowAdd"
                >
                </datatable-body-row>
              }
            }
          </datatable-row-wrapper>
        }

        @if (summaryRow && summaryPosition === 'bottom') {
          <datatable-summary-row
            role="row"
            [ngStyle]="getBottomSummaryRowStyles()"
            [rowHeight]="summaryHeight"
            [offsetX]="offsetX"
            [innerWidth]="innerWidth"
            [rows]="rows"
            [columns]="columns"
            [summaryCurrency]="summaryCurrency"
          >
          </datatable-summary-row>
        }
      </div>
    }
  </datatable-scroller>
  @if (!rows?.length && !loadingIndicator) {
    <div class="empty-row" [innerHTML]="emptyMessage | vrdtranslator"></div>
  }
</datatable-selection>
