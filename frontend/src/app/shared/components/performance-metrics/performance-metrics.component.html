<div class="performance-metrics">
  <h3>Métricas de Performance</h3>
  
  <div class="metrics-grid">
    <!-- CPU Usage -->
    <div class="metric-card cpu">
      <div class="metric-header">
        <i class="fas fa-microchip"></i>
        <span class="metric-title">CPU</span>
      </div>
      <div class="metric-content">
        <div class="metric-value">
          <span class="percentage">{{ getCpuUsage() }}%</span>
        </div>
        <div class="metric-bar">
          <div class="progress-bar">
            <div class="progress-fill" 
                 [style.width.%]="getCpuUsage()"
                 [class]="getStatusClass(getCpuUsage())">
            </div>
          </div>
        </div>
        <div class="metric-details" *ngIf="cpuData.length > 0">
          <small>Load: {{ cpuData[0]?.loadAvg?.join(', ') || 'N/A' }}</small>
        </div>
      </div>
    </div>

    <!-- Memory Usage -->
    <div class="metric-card memory">
      <div class="metric-header">
        <i class="fas fa-memory"></i>
        <span class="metric-title">Memória</span>
      </div>
      <div class="metric-content">
        <div class="metric-value">
          <span class="percentage">{{ getMemoryUsage() }}%</span>
        </div>
        <div class="metric-bar">
          <div class="progress-bar">
            <div class="progress-fill" 
                 [style.width.%]="getMemoryUsage()"
                 [class]="getStatusClass(getMemoryUsage())">
            </div>
          </div>
        </div>
        <div class="metric-details" *ngIf="memoryData.length > 0">
          <small>
            {{ formatBytes(memoryData[0]?.used || 0) }} / {{ formatBytes(memoryData[0]?.total || 0) }}
          </small>
        </div>
      </div>
    </div>

    <!-- Disk Usage -->
    <div class="metric-card disk">
      <div class="metric-header">
        <i class="fas fa-hdd"></i>
        <span class="metric-title">Disco</span>
      </div>
      <div class="metric-content">
        <div class="metric-value">
          <span class="percentage">{{ getDiskUsage() }}%</span>
        </div>
        <div class="metric-bar">
          <div class="progress-bar">
            <div class="progress-fill" 
                 [style.width.%]="getDiskUsage()"
                 [class]="getStatusClass(getDiskUsage())">
            </div>
          </div>
        </div>
        <div class="metric-details" *ngIf="diskData.length > 0">
          <small>
            {{ formatBytes(diskData[0]?.used || 0) }} / {{ formatBytes(diskData[0]?.total || 0) }}
          </small>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed metrics table for multiple minions -->
  <div class="detailed-metrics" *ngIf="cpuData.length > 1 || memoryData.length > 1 || diskData.length > 1">
    <h4>Detalhes por Minion</h4>
    <div class="metrics-table">
      <table>
        <thead>
          <tr>
            <th>Minion</th>
            <th>CPU (%)</th>
            <th>Memória (%)</th>
            <th>Disco (%)</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cpu of cpuData; let i = index">
            <td>{{ cpu.minion }}</td>
            <td>
              <span class="metric-badge" [class]="getStatusClass(cpu.usage || 0)">
                {{ (cpu.usage || 0) | number:'1.1-1' }}%
              </span>
            </td>
            <td>
              <span class="metric-badge" [class]="getStatusClass(getMemoryUsage())">
                {{ getMemoryUsage() | number:'1.1-1' }}%
              </span>
            </td>
            <td>
              <span class="metric-badge" [class]="getStatusClass(getDiskUsage())">
                {{ getDiskUsage() | number:'1.1-1' }}%
              </span>
            </td>
            <td>
              <span class="status-badge" [class]="getStatusClass(Math.max(cpu.usage || 0, getMemoryUsage(), getDiskUsage()))">
                <i class="fas fa-circle"></i>
                {{ getStatusClass(Math.max(cpu.usage || 0, getMemoryUsage(), getDiskUsage())) === 'good' ? 'OK' : 
                   getStatusClass(Math.max(cpu.usage || 0, getMemoryUsage(), getDiskUsage())) === 'warning' ? 'Atenção' : 'Crítico' }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="no-data" *ngIf="cpuData.length === 0 && memoryData.length === 0 && diskData.length === 0">
    <i class="fas fa-chart-line"></i>
    <p>Nenhuma métrica disponível</p>
  </div>
</div>